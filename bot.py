import datetime
import os

from telegram import ReplyKeyboardMarkup, KeyboardButton, Update
from telegram.ext import (
    Application,
    CommandHandler,
    MessageHandler,
    ContextTypes,
    filters,
)

TOKEN = os.environ["BOT_TOKEN"]

# –ö—Ç–æ —É–∂–µ –ø–∏—Å–∞–ª –±–æ—Ç—É (–¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π).
SUBSCRIBERS: set[int] = set()

INTRO_TEXT = (
    "üåø *–°–ø–æ–∫–æ–π–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å*\n\n"
    "–ü—Ä–∏–≤–µ—Ç, —è –û–ª—å–≥–∞ –ú–∏—Ç–∏–Ω–∞, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥.\n"
    "–Ø –º–Ω–æ–≥–æ –ª–µ—Ç —Ä–∞–±–æ—Ç–∞—é —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏, –∏ —ç—Ç–æ –º–æ—è –∫–æ—Ä–æ—Ç–∫–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞\n"
    "*¬´–°–ø–æ–∫–æ–π–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å¬ª* (—Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞).\n\n"
    "‚ú® *–ó–¥–µ—Å—å –ø—Ä–æ:*\n"
    "‚Ä¢ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –æ–ø–æ—Ä—É\n"
    "‚Ä¢ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –¥—Ä—É–≥–∏—Ö\n"
    "‚Ä¢ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–π –∫–æ–Ω—Ç–∞–∫—Ç —Å —Å–æ–±–æ–π\n"
    "‚Ä¢ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±—ã—Ç—å —Å–æ–±–æ–π –∏ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –æ–∫—Ä—É–∂–∞—é—â–∏—Ö\n\n"
    "üïä *–ó–∞ 6 –¥–Ω–µ–π –∏ 6 –Ω–µ–±–æ–ª—å—à–∏—Ö –∑–∞–¥–∞–Ω–∏–π –º—ã –ø—Ä–∏–¥–µ–º –∫ —Ç–∞–∫–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É:*\n"
    "*¬´–ú–Ω–µ –≤–Ω—É—Ç—Ä–∏ —Å–ø–æ–∫–æ–π–Ω–µ–µ. –Ø –º–µ–Ω—å—à–µ –¥—ë—Ä–≥–∞—é—Å—å –∏ —Å–æ–º–Ω–µ–≤–∞—é—Å—å¬ª*\n\n"
    "–ü—Ä–æ—Ö–æ–¥–∏ —Ç—Ä–µ–Ω–∏–Ω–≥ –≤ —Å–≤–æ—ë–º —Ç–µ–º–ø–µ –∏ —Å –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ —Å–µ–±–µ.\n"
    "–¢—ã –≥–æ—Ç–æ–≤–∞?"
)

# ‚ö†Ô∏è –í–ê–ñ–ù–û:
# video_note ‚Äî —ç—Ç–æ file_id –∫—Ä—É–∂–æ—á–∫–∞. –ü–æ–∫–∞ –ø—É—Å—Ç–æ ("") ‚Äî –∫—Ä—É–∂–æ—á–µ–∫ –ø—Ä–æ—Å—Ç–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è.
# –ö–æ–≥–¥–∞ –ø–æ–ª—É—á–∏—à—å file_id, –≤—Å—Ç–∞–≤—å –µ–≥–æ —Å—é–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è.

DAYS = {
    1: {
        "photo": "day1.jpg",
        "video_note": "",  # <-- —Å—é–¥–∞ –≤—Å—Ç–∞–≤–∏—à—å file_id day1
        "first": (
            "üü¢ *–î–µ–Ω—å 1. –ì–¥–µ —è —Ç–µ—Ä—è—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å*\n\n"
            "*–§–æ–∫—É—Å:* –æ—Å–æ–∑–Ω–∞–Ω–∏–µ, –∞ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.\n"
            "*–°–º—ã—Å–ª:* –ú—ã –Ω–µ –º–æ–∂–µ–º –æ–ø–µ—Ä–µ—Ç—å—Å—è —Ç—É–¥–∞, —á–µ–≥–æ –Ω–µ –≤–∏–¥–∏–º."
        ),
        "parts": [
            "‚úçÔ∏è *–¢–µ–∫—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ*\n\n"
            "–û—Ç–≤–µ—Ç—å –ø–∏—Å—å–º–µ–Ω–Ω–æ:\n"
            "- –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏?\n"
            "- –ö–∞–∫–∏–µ –º—ã—Å–ª–∏ –æ —Å–µ–±–µ –ø–æ—è–≤–∏–ª–∏—Å—å?\n"
            "- –ß—Ç–æ —è –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∞ –≤ —Ç–µ–ª–µ?\n"
            "- –ß–µ–≥–æ —è –∏—Å–ø—É–≥–∞–ª–∞—Å—å –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç?\n"
            "- –ß–µ–≥–æ —è –±–æ—é—Å—å –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ? (–ø–æ–∫–∞ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –æ—á–µ–≤–∏–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞. –û—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞ –ø–æ—Ç–æ–º)\n\n"
            "–¢—ã –¥–µ–ª–∞–µ—à—å —ç—Ç—É —Ä–∞–±–æ—Ç—É –¥–ª—è —Å–µ–±—è, –ø–æ—ç—Ç–æ–º—É –ø–æ–ø—Ä–æ–±—É–π –æ—Ç–≤–µ—á–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∏—Å–∫—Ä–µ–Ω–Ω–µ.",
            "üß≠ *–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:*\n\n"
            "–°–µ–≥–æ–¥–Ω—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –±—ã—Ç—å ¬´–ø—Ä–æ–±–ª–µ–º–æ–π¬ª, –æ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º."
        ],
    },
    2: {
        "photo": "day2.jpg",
        "video_note": "",  # <-- file_id day2
        "first": (
            "üü° *–î–µ–Ω—å 2. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∏–∞–ª–æ–≥*\n\n"
            "*–§–æ–∫—É—Å:* –∫–∞–∫ —Ç—ã —Å —Å–æ–±–æ–π –≥–æ–≤–æ—Ä–∏—à—å, –∫–æ–≥–¥–∞ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è.\n"
            "*–°–º—ã—Å–ª:* –ù–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —á–∞—Å—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–µ —Å–∏—Ç—É–∞—Ü–∏–µ–π, –∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ç–æ—Ä–æ–º."
        ),
        "parts": [
            "‚úçÔ∏è *–¢–µ–∫—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ*\n\n"
            "–í—ã–ø–∏—à–∏ —Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –≥–æ–≤–æ—Ä–∏—à—å —Å–µ–±–µ –≤ –º–æ–º–µ–Ω—Ç—ã —Å–æ–º–Ω–µ–Ω–∏–π.\n"
            "–†–∞–∑–¥–µ–ª–∏ –∏—Ö –Ω–∞:\n"
            "- —Ñ–∞–∫—Ç—ã\n"
            "- –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ / –æ–±–≤–∏–Ω–µ–Ω–∏—è\n"
            "- –ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π 1-2 –∂—ë—Å—Ç–∫–∏–µ —Ñ—Ä–∞–∑—ã –≤ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ.\n\n"
            "–ü—Ä–∏–º–µ—Ä:\n"
            "¬´–Ø –≤—Å—ë –∏—Å–ø–æ—Ä—Ç–∏–ª–∞¬ª ‚Üí ¬´–ú–Ω–µ –±—ã–ª–æ —Å–ª–æ–∂–Ω–æ, —è —Ä–∞—Å—Ç–µ—Ä—è–ª–∞—Å—å¬ª.\n\n"
            "–î–æ–ø–∏—Å–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã\n",
            "üß≠ *–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:*\n\n"
            "–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ –ø–æ–º–µ–Ω—è–ª–æ—Å—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ: —á—É—Ç—å –º–µ–Ω—å—à–µ –¥–∞–≤–ª–µ–Ω–∏—è –∏–∑–Ω—É—Ç—Ä–∏ ‚Üí –±–æ–ª—å—à–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è."
        ],
    },
    3: {
        "photo": "day3.jpg",
        "video_note": "",  # <-- file_id day3
        "first": (
            "üü† *–î–µ–Ω—å 3. –°—Ç—Ä–∞—Ö –æ—Ü–µ–Ω–∫–∏*\n"
            "–∫–ª—é—á–µ–≤–æ–π –¥–µ–Ω—å\n\n"
            "*–§–æ–∫—É—Å:* –Ω–µ ¬´—É–±—Ä–∞—Ç—å —Å—Ç—Ä–∞—Ö¬ª, –∞ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –µ–≥–æ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å.\n"
            "*–°–º—ã—Å–ª:* –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –Ω–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–∞—Ö–∞, –∞ –∫–æ–Ω—Ç–∞–∫—Ç —Å —Å–æ–±–æ–π –ø—Ä–∏ —Å—Ç—Ä–∞—Ö–µ."
        ),
        "parts": [
            "‚úçÔ∏è *–¢–µ–∫—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ*\n\n"
            "–ü—Ä–æ–¥–æ–ª–∂–∏ —Ñ—Ä–∞–∑—É:\n"
            "¬´–ï—Å–ª–∏ –º–µ–Ω—è –æ—Å—É–¥—è—Ç / —Ä–∞—Å–∫—Ä–∏—Ç–∏–∫—É—é—Ç, —Ç–æ...¬ª\n\n"
            "–î–æ–π–¥–∏ –¥–æ —Å–∞–º–æ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è. –ü—É—Å—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç —Å–∞–º—ã–º —É–∂–∞—Å–Ω—ã–º, —á—Ç–æ —Ç—ã —Ç–æ–ª—å–∫–æ –º–æ–∂–µ—à—å —Å–µ–±–µ –≤–æ–æ–±—Ä–∞–∑–∏—Ç—å. "
            "–ß—Ç–æ —Å–∞–º–æ–µ —Ö—É–¥—à–µ–µ –º–æ–∂–µ—Ç —Å —Ç–æ–±–æ–π –ø—Ä–æ–∏–∑–æ–π—Ç–∏.",
            "üß≠ *–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:*\n\n"
            "–ó–∞–º–µ—Ç—å, —á—Ç–æ —Å—Ç—Ä–∞—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω–µ–µ –≤—Å–µ—Å–∏–ª—å–Ω—ã–º. –ò–Ω–æ–≥–¥–∞ –º—ã —Å–∏–ª—å–Ω–æ –±–æ–∏–º—Å—è —Å–∞–º–æ–≥–æ —Å—Ç—Ä–∞—Ö–∞, –Ω–µ–∂–µ–ª–∏ —Ç–æ–≥–æ, —á—Ç–æ —Å—Ç–æ–∏—Ç –∑–∞ –Ω–∏–º –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ."
        ],
    },
    4: {
        "photo": "day4.jpg",
        "video_note": "",  # <-- file_id day4
        "first": (
            "üîµ *–î–µ–Ω—å 4. –ü—Ä–∞–≤–æ –±—ã—Ç—å —Å–æ–±–æ–π*\n\n"
            "*–§–æ–∫—É—Å:* —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ.\n"
            "*–°–º—ã—Å–ª:* –ú–Ω—è–≥–∏–µ —Ç–µ—Ä—è—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ç–∞–º, –≥–¥–µ –∑–∞–ø—Ä–µ—â–∞—é—Ç —Å–µ–±–µ –±—ã—Ç—å: –Ω–µ–∏–¥–µ–∞–ª—å–Ω–æ–π, –º–µ–¥–ª–µ–Ω–Ω–æ–π, ¬´–Ω–µ—É–¥–æ–±–Ω–æ–π¬ª, –≤ –æ–±—â–µ–º –∫–∞–∫–æ–π-—Ç–æ –Ω–µ —Ç–∞–∫–æ–π."
        ),
        "parts": [
            "‚úçÔ∏è *–¢–µ–∫—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ*\n\n"
            "–û—Ç–≤–µ—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã:\n"
            "- –ì–¥–µ —è —Å—Ç–∞—Ä–∞—é—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å?\n"
            "- –ì–¥–µ –±–æ—é—Å—å –±—ã—Ç—å ¬´–Ω–µ —Ç–∞–∫–æ–π¬ª?  –ü—Ä–æ–¥–æ–ª–∂–∏ —Ñ—Ä–∞–∑—É:\n"
            "¬´–Ø –∑–∞–ø—Ä–µ—â–∞—é —Å–µ–±–µ –±—ã—Ç—å...¬ª\n\n"
            "–û—Ç–≤–µ—Ç—å –µ—â–µ –Ω–∞ —ç—Ç–∏ 2 –≤–æ–ø—Ä–æ—Å–∞:\n"
            "- –ö—Ç–æ –º–Ω–µ —ç—Ç–æ –∑–∞–ø—Ä–µ—Ç–∏–ª?\n"
            "- –ß—Ç–æ —Å–ª—É—á–∏—Ç—Å—è, –µ—Å–ª–∏ —è –ø–æ–∑–≤–æ–ª—é —Å–µ–±–µ —ç—Ç–æ —á—É—Ç—å-—á—É—Ç—å?\n\n"
            "–î–æ–±–∞–≤–∏—Ç—å —Å–∫–∞–∑–≤–æ–º –°–µ–≥–æ–¥–Ω—è —É –Ω–∞—Å –ø–µ—Ä–≤–æ–µ –º–∞–ª–µ–Ω—å–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–Ω—è:\n"
            "–†–∞–∑—Ä–µ—à–∏ —Å–µ–±–µ –±—ã—Ç—å —Å–æ–±–µ–π —á—É—Ç—å –±–æ–ª—å—à–µ, —á–µ–º –æ–±—ã—á–Ω–æ.",
            "üß≠ *–û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:*\n\n"
            "–ü–æ—è–≤–ª—è–µ—Ç—Å—è –æ—â—É—â–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è."
        ],
    },
    5: {
        "photo": "day5.jpg",
        "video_note": "",  # <-- file_id day5
        "first": (
            "üü£ *–î–µ–Ω—å 5. –°–±–æ—Ä–∫–∞ –æ–ø–æ—Ä—ã*\n\n"
            "*–§–æ–∫—É—Å:* –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è\n"
            "*–°–º—ã—Å–ª:* –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —ç—Ç–æ –Ω–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∞ –Ω–∞–≤—ã–∫ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –∫ —Å–µ–±–µ."
        ),
        "parts": [
            "‚úçÔ∏è *–¢–µ–∫—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ*\n\n"
            "–û—Ç–≤–µ—Ç—å –ø–∏—Å—å–º–µ–Ω–Ω–æ:\n"
            "- –ù–∞ —á—Ç–æ —è –º–æ–≥—É –æ–ø–∏—Ä–∞—Ç—å—Å—è, –∫–æ–≥–¥–∞ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è?\n"
            "- –ß—Ç–æ –≤–æ –º–Ω–µ –æ—Å—Ç–∞—ë—Ç—Å—è, –¥–∞–∂–µ –≤ –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏?\n\n"
            "–°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π —Ñ—Ä–∞–∑—É-–æ–ø–æ—Ä—É.\n"
            "–ó–∞–ø–æ–ª–Ω–∏:\n"
            "¬´–ö–æ–≥–¥–∞ —è —Å–Ω–æ–≤–∞ —Å–æ–º–Ω–µ–≤–∞—é—Å—å, —è –¥–µ–ª–∞—é...¬ª\n\n"
            "–î–æ–ø–∏—Å–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã"
        ],
    },
    6: {
        "photo": "day6.jpg",
        "video_note": "",  # <-- file_id day6
        "first": (
            "üü§ *–î–µ–Ω—å 6. –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–µ–±–µ*"
        ),
        "parts": [
            "‚úçÔ∏è *–¢–µ–∫—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ*\n\n"
            "1. –î–∞–≤–∞–π –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ–ø—ã—Ç\n"
            "–û—Ç–≤–µ—Ç—å –ø–∏—Å—å–º–µ–Ω–Ω–æ:\n"
            "- –í –∫–∞–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –∑–∞ —ç—Ç–∏ –¥–Ω–∏ –º–Ω–µ –±—ã–ª–æ —Å–ø–æ–∫–æ–π–Ω–µ–µ –≤—Å–µ–≥–æ?\n"
            "- –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –º–Ω–µ –ø–æ–º–æ–≥–ª–æ?\n"
            "- –ß—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ —è –º–æ–≥—É –±—Ä–∞—Ç—å —Å —Å–æ–±–æ–π –¥–∞–ª—å—à–µ?\n\n"
            "2. –ú–æ–π –ª–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –∫ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏\n"
            "–ó–∞–ø–æ–ª–Ω–∏ —Å—Ö–µ–º—É:\n"
            "–ö–æ–≥–¥–∞ —è –∑–∞–º–µ—á–∞—é, —á—Ç–æ —Å–æ–º–Ω–µ–≤–∞—é—Å—å –∏–ª–∏ —Ç–µ—Ä—è—é –æ–ø–æ—Ä—É:\n"
            "–Ø —Å–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞—é\n"
            "- (–ø–∞—É–∑–∞, –¥—ã—Ö–∞–Ω–∏–µ, —Ç–µ–ª–µ—Å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç)\n"
            "–Ø –≥–æ–≤–æ—Ä—é —Å–µ–±–µ\n"
            "(Apasa-onopa)\n"
            "–Ø –Ω–∞–ø–æ–º–∏–Ω–∞—é —Å–µ–±–µ\n"
            "_ (—á—Ç–æ —Å—Ç—Ä–∞—Ö - –Ω–µ –æ–ø–∞—Å–Ω–æ—Å—Ç—å / —è –º–æ–≥—É –≤—ã–¥–µ—Ä–∂–∞—Ç—å –∏ —Ç.–¥.)\n"
            "–Ø –≤—ã–±–∏—Ä–∞—é\n"
            "_ (–º–∞–ª–µ–Ω—å–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤–º–µ—Å—Ç–æ –∏–∑–±–µ–≥–∞–Ω–∏—è)\n\n"
            "3. –í–∞–∂–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å–µ–±–µ\n"
            "–ó–∞–∫–æ–Ω—á–∏ —Ñ—Ä–∞–∑—É:\n"
            "¬´–ú–Ω–µ –Ω–µ –Ω—É–∂–Ω–æ –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ–π –≤—Å–µ–≥–¥–∞, —á—Ç–æ–±—ã...¬ª (... –∏–º–µ—Ç—å –ø—Ä–∞–≤–æ –≥–æ–≤–æ—Ä–∏—Ç—å, –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å, –±—ã—Ç—å —Å–æ–±–æ–π, –∂–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å)",
            "üåø *–§–∏–Ω–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞*\n\n"
            "–¢—ã –Ω–µ —Å—Ç–∞–ª–∞ ¬´–¥—Ä—É–≥–æ–π¬ª.\n"
            "–¢—ã —Å—Ç–∞–ª–∞ –∫ —Å–µ–±–µ –±–ª–∏–∂–µ. –ê —ç—Ç–æ –∏ –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞ —Å–ø–æ–∫–æ–π–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏."
        ],
    },
}

# -------- –ú–ï–ù–Æ (–í–°–ï–ì–î–ê –í–ù–ò–ó–£) --------

BTN_HOME = "üè† –í –Ω–∞—á–∞–ª–æ"
BTN_DAY1 = "üü¢ –î–µ–Ω—å 1"
BTN_DAY2 = "üü° –î–µ–Ω—å 2"
BTN_DAY3 = "üü† –î–µ–Ω—å 3"
BTN_DAY4 = "üîµ –î–µ–Ω—å 4"
BTN_DAY5 = "üü£ –î–µ–Ω—å 5"
BTN_DAY6 = "üü§ –î–µ–Ω—å 6"
BTN_HELP = "‚ÑπÔ∏è –ü–æ–º–æ—â—å"

def main_menu() -> ReplyKeyboardMarkup:
    keyboard = [
        [KeyboardButton(BTN_HOME), KeyboardButton(BTN_HELP)],
        [KeyboardButton(BTN_DAY1), KeyboardButton(BTN_DAY2), KeyboardButton(BTN_DAY3)],
        [KeyboardButton(BTN_DAY4), KeyboardButton(BTN_DAY5), KeyboardButton(BTN_DAY6)],
    ]
    return ReplyKeyboardMarkup(
        keyboard=keyboard,
        resize_keyboard=True,
        one_time_keyboard=False,
        input_field_placeholder="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å‚Ä¶",
    )

# -------- DEBUG: –ü–û–õ–£–ß–ï–ù–ò–ï file_id –î–õ–Ø –ö–†–£–ñ–û–ß–ö–ê --------
# –û—Ç–ø—Ä–∞–≤—å –±–æ—Ç—É –∫—Ä—É–∂–æ—á–µ–∫ ‚Äî –æ–Ω –æ—Ç–≤–µ—Ç–∏—Ç file_id.
async def debug_video_note(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    SUBSCRIBERS.add(chat_id)

    if update.message and update.message.video_note:
        file_id = update.message.video_note.file_id
        await update.message.reply_text(f"file_id:\n{file_id}", reply_markup=main_menu())

# -------- –≠–ö–†–ê–ù–´ --------

async def show_home(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    SUBSCRIBERS.add(chat_id)

    with open("olga.jpg", "rb") as photo:
        await update.message.reply_photo(
            photo=photo,
            caption=INTRO_TEXT,
            parse_mode="Markdown",
            reply_markup=main_menu()
        )

async def send_day(update: Update, context: ContextTypes.DEFAULT_TYPE, day_num: int):
    chat_id = update.effective_chat.id
    SUBSCRIBERS.add(chat_id)

    day = DAYS.get(day_num)
    if not day:
        await update.message.reply_text("–¢–∞–∫–æ–≥–æ –¥–Ω—è –Ω–µ—Ç.", reply_markup=main_menu())
        return

    # 1) —Ñ–æ—Ç–æ + –∑–∞–≥–æ–ª–æ–≤–æ–∫/—Ñ–æ–∫—É—Å/—Å–º—ã—Å–ª
    with open(day["photo"], "rb") as photo:
        await update.message.reply_photo(
            photo=photo,
            caption=day["first"],
            parse_mode="Markdown",
            reply_markup=main_menu()
        )

    # 2) –∫—Ä—É–∂–æ—á–µ–∫ (video note) –ø–æ file_id ‚Äî –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏
    vn_id = (day.get("video_note") or "").strip()
    if vn_id:
        try:
            await update.message.reply_video_note(video_note=vn_id)
        except Exception:
            # –µ—Å–ª–∏ file_id –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π/—É—Å—Ç–∞—Ä–µ–ª ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–∞–¥–∞–µ–º
            pass

    # 3) –æ—Å—Ç–∞–ª—å–Ω—ã–µ —á–∞—Å—Ç–∏ –¥–Ω—è
    for part in day["parts"]:
        await update.message.reply_text(part, parse_mode="Markdown")

# -------- –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï 12:00 --------

async def daily_reminder(context: ContextTypes.DEFAULT_TYPE):
    for chat_id in list(SUBSCRIBERS):
        try:
            await context.bot.send_message(
                chat_id=chat_id,
                text=(
                    "‚è∞ *–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ*\n\n"
                    "–ï—Å–ª–∏ —Å–µ–≥–æ–¥–Ω—è –µ—Å—Ç—å –º–µ—Å—Ç–æ ‚Äî –ø—Ä–æ–π–¥–∏ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –ø—Ä–æ–≥—Ä–∞–º–º—ã üíö\n"
                    "–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –≤ –º–µ–Ω—é –≤–Ω–∏–∑—É üëá"
                ),
                parse_mode="Markdown",
                reply_markup=main_menu()
            )
        except Exception:
            pass

# -------- –•–ï–ù–î–õ–ï–†–´ --------

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await show_home(update, context)

async def on_text(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    SUBSCRIBERS.add(chat_id)

    text = (update.message.text or "").strip()

    if text == BTN_HOME:
        await show_home(update, context)
        return

    if text == BTN_DAY1:
        await send_day(update, context, 1); return
    if text == BTN_DAY2:
        await send_day(update, context, 2); return
    if text == BTN_DAY3:
        await send_day(update, context, 3); return
    if text == BTN_DAY4:
        await send_day(update, context, 4); return
    if text == BTN_DAY5:
        await send_day(update, context, 5); return
    if text == BTN_DAY6:
        await send_day(update, context, 6); return

    if text == BTN_HELP:
        await update.message.reply_text(
            "‚ÑπÔ∏è –ú–µ–Ω—é –≤—Å–µ–≥–¥–∞ –≤–Ω–∏–∑—É.\n"
            "–í—ã–±–∏—Ä–∞–π –¥–µ–Ω—å (üü¢‚Äìüü§) –∏–ª–∏ –Ω–∞–∂–∏–º–∞–π üè† –í –Ω–∞—á–∞–ª–æ.",
            reply_markup=main_menu()
        )
        return

    await update.message.reply_text(
        "–Ø —Ç–µ–±—è –≤–∏–∂—É üíô\n"
        "–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É üëá",
        reply_markup=main_menu()
    )

def main():
    app = Application.builder().token(TOKEN).build()

    # –≤–∞–∂–Ω–æ: —Å–Ω–∞—á–∞–ª–∞ –ª–æ–≤–∏–º –∫—Ä—É–∂–æ—á–∫–∏, –ø–æ—Ç–æ–º –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.VIDEO_NOTE, debug_video_note))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, on_text))

    app.job_queue.run_daily(
        daily_reminder,
        time=datetime.time(hour=12, minute=0)
    )

    app.run_polling()

if __name__ == "__main__":
    main()
